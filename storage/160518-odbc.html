title: windows 10에서 ODBC data source 설정 방법
tag: MSSQL, DB
<p>
   C++에서 MSSQL DB을 연결하는 data access programming을 하기 위해선 ODBC data source를 설정해야 함.
</p>
<ol>
    <li>ODBC data source 찾기</li>
    <li>ODBC data source 설정</li>
</ol>
<h3>specifications</h3>
<ul>
    <li>windows 10</li>
    <li>ODBC driver 11</li>
    <li>SQL Server 2014 Express</li>
</ul>

<h3>ODBC data source 찾기</h3>
<p>
    data source 설정에 접근하는 방법은 크게 두가지가 있음.
</p>
<ul>
    <li>시작 메뉴에서</li>
    <p>
        all aps -> Windows Administrative Tools -> ODBC data sources (32 bit / 64 bit) 
    </p>
    <li>settings panel에서</li>
    <p>
        Find a setting -> ODBC -> Set up ODBC data sources (32 bit / 64 bit)
    </p>
</ul>

<h3>ODBC data sources 설정</h3>
<ol>
    <li>"User DSN" tab 선택</li>
    <p>
        User DSN 외에도 여러 탭이 있는데, 각각 만드려는 ODBC Data source에 접근 범위를 설정하는 것. 시스템에 여러 user가 있고 모두 같은 data source를 쓰려면 System DSN으로 하는게 편함.
        <ul>
            <li>User DSN: 현재 user만 사용할 수 있으며, 현재 컴퓨터에 local인 data source를 생성.</li>
            <li>System DSN: 시스템의 모든 user가 사용할 수 있으며, 현재 컴퓨터에 local인 data source를 생성.</li>
            <li>File DSN: 동일한 드라이버를 설치한 모든 사용자들이 공유할 수 있는 파일 기반 data source를 생성. 현재 컴퓨터에 local 아니어도 가능.</li>
            <li>Tracing: 이 탭은 ODBC 드라이버 관리자가 ODBC 함수 호출을 추적하는 방법을 지정. 캡쳐된 내용은 로그 파일에 저장됨.</li>
            <li>Connection Pooling: 응용 프로그램이 연결 풀에서 연결을 다시 사용할 수 있도록 함. 연결 풀링을 사용할 때 연결 재시도 대기 시간 및 시간 제한(초)을 변경 가능.</li>
        </ul>
    </p>
    <li>"Add" -> "ODBC Driver 11 for SQL Server" 선택</li>
    <p>
        Access나 Excel, SQL Server, ODBC Driver 등 data source를 연결할 드라이버를 지정 가능. ODBC를 이용해서 연결하므로 "ODBC Driver 11 for SQL Server" 또는 SQL Server 선택. 
        <ul>
            <li>ODBC Driver 11 for SQL Server </li>
            <p>
                SQL Server가 local인 경우 사용 가능.
            </p>
            <li>SQL Server</li>
            <p>
                SQL Server가 local이거나 remote 인 경우 사용 가능. 이후 설정 과정에서 "Client Configuration"을 named pipe(local), 혹은 TCP/IP(remote)로 설정을 바꿔줘야 함.
                 
            </p>
            <li>SQL Server Navtive Client 11.0</li>
            <p>
                application이 C 언어로 작성되는 경우. (확인 필요)
            </p>
        </ul>
    </p>
    <li>Name에 원하는 서버 이름, Server에 연결할 서버 작성</li>
    //rev fig.1
    <p>
        <ul>
            <li>Name: 외부에 표시되는 서버 이름</li>
            <li>Description: 외부에 표시되는 서버 설명</li>
            <li>Server: 접속할 SQL server. SQL Server Management Studio에서 connection 시의 Server Name을 입력.</li>
        </ul>
    </p>
    <li>Authentication 방법 설정</li>
    //rev fig.2
    <li>Default Database 설정</li>
    //rev fig.3
    <p>
        기본은 master. SQL Server 내에서 미리 작성해놓은 Database 선택. 
    </p>
    <li>기타 설정</li>
</ol>

<h3>ODBC data sources 설정 - remote(TCP/IP)인 경우 </h3>
<ul>
    <li><a href="https://support.microsoft.com/ko-kr/kb/195566">TCP/IP 소켓 구성 |Microsoft Support</a></li>
    <li><a href="http://web.synametrics.com/sqlexpressremote.htm">SQL Express and remote connections |synametrics.com</a></li>
    <li><a href="http://www.icancrm.com/app/odbc/index.asp?ref=mssql">원격서버 DB의 연결 방법 (ODBC) |icancrm.com</a></li>
</ul>

<h3>reference</h3>
<ul>
    <li><a href="https://support.microsoft.com/ko-kr/kb/965049">Microsoft SQL Server ODBC 데이터 원본을 설정 하는 방법 |Microsoft Support</a></li>
    <li><a href="http://windows.microsoft.com/ko-kr/windows/using-odbc-data-source-administrator#1TC=windows-7">ODBC 데이터 원본 관리자 사용 |Microsoft Windows Q/A</a></li>
    <li><a href="http://blog.danggun.net/1003">ODBC 설정하기 |당근 블로그</a></li>
</ul>